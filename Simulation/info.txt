NacreGrowthSimv6 is the function that simulates nacre growth as shown in Fig. 3 and S5. Inputs and outputs are described in the header of the function itself. All decisionmaking is made upfront, so running a simulation is as simple as inputting whatever values you would like to try and then letting it run. It will automatically show the a- and c- axis orientation maps when it is finished.

TwinBHist takes the orientation map outputs of the simulation (aori and cori), the grain assignments (gn), and a minimum grain size to output the misorientation in a between adjacent grains with the same c-axis orientation. Note that for the sake of simplicity, the simulation uses a twin misorientation of 116° rather than the true 116.2°, so the output misorientations will be the closest integer to the real twin multiple.

TwinFrequencySim takes the "hist" output from TwinBHist and gives a count of each twin multiple up to 4, including 0 (representing adjacent grains co-oriented in c but not at a twin multiple misorientation in a). This data is shown in Fig. 4.
